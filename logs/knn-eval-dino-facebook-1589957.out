INFO:    underlay of /usr/bin/nvidia-smi required more than 50 (517) bind mounts
[2024-11-22 20:51:10,771][dino.__main__][INFO] - cmd: evaluate
finetune:
  model_dir: ${hydra:runtime.cwd}/models/
  model_tag: vit_dino_s_image_net_linear_probe
  base_lr: 0.001
  backbone_lr: 1.0e-05
  num_epochs: 10
  batch_size: 32
  mode: LINEAR_PROBE
  dataset:
    type_: IMAGE_FOLDER
    transform: DEFAULT
    data_dir: ${hydra:runtime.cwd}/data/tiny-imagenet-200/train
    train: true
  backbone:
    model_type: VIT_DINO_S
    pretrained_weights: null
  head:
    model_type: LINEAR
    output_dim: 1000
    pretrained_weights: null
    hidden_dim: 2048
evaluate:
  mode: KNN
  dataset:
    type_: IMAGE_FOLDER
    transform: DEFAULT
    data_dir: /input-data
    train: true
  backbone:
    model_type: VIT_DINO_S
    pretrained_weights: null
  batch_size: 64
  k: 1
  topk:
  - 1
  head: ???
train:
  model_dir: ${hydra:runtime.cwd}/models/
  model_tag: default
  dataset_dir: ${hydra:runtime.cwd}/data/tiny-imagenet-200/train
verbose: true
log_dir: /logs

[2024-11-22 20:51:10,773][dino.entry_points.evaluation][INFO] - Running KNN evaluation
Using cache found in /home/pml20/.cache/torch/hub/facebookresearch_dino_main
[2024-11-22 20:51:12,062][dino.entry_points.evaluation][INFO] - Loaded model with backbone ModelType.VIT_DINO_S
[2024-11-22 20:51:12,089][dino.entry_points.evaluation][INFO] - Loaded train dataset: len(train_ds)=8516
[2024-11-22 20:51:12,114][dino.entry_points.evaluation][INFO] - Loaded eval dataset: len(eval_ds)=953
[2024-11-22 20:51:12,263][dino.evaluators][INFO] - Extracting features ...
  0%|          | 0/134 [00:00<?, ?it/s]  1%|          | 1/134 [00:02<06:11,  2.80s/it]  1%|▏         | 2/134 [00:04<05:05,  2.32s/it]  2%|▏         | 3/134 [00:06<04:42,  2.15s/it]  3%|▎         | 4/134 [00:08<04:30,  2.08s/it]  4%|▎         | 5/134 [00:10<04:22,  2.04s/it]  4%|▍         | 6/134 [00:12<04:17,  2.01s/it]  5%|▌         | 7/134 [00:14<04:13,  1.99s/it]  6%|▌         | 8/134 [00:16<04:10,  1.98s/it]  7%|▋         | 9/134 [00:18<04:07,  1.98s/it]  7%|▋         | 10/134 [00:20<04:04,  1.97s/it]  8%|▊         | 11/134 [00:22<04:02,  1.97s/it]  9%|▉         | 12/134 [00:24<04:00,  1.97s/it] 10%|▉         | 13/134 [00:26<03:58,  1.97s/it] 10%|█         | 14/134 [00:28<03:56,  1.97s/it] 11%|█         | 15/134 [00:30<03:54,  1.97s/it] 12%|█▏        | 16/134 [00:32<03:51,  1.97s/it] 13%|█▎        | 17/134 [00:34<03:49,  1.96s/it] 13%|█▎        | 18/134 [00:36<03:47,  1.96s/it] 14%|█▍        | 19/134 [00:38<03:45,  1.96s/it] 15%|█▍        | 20/134 [00:40<03:43,  1.96s/it] 16%|█▌        | 21/134 [00:42<03:41,  1.96s/it] 16%|█▋        | 22/134 [00:44<03:39,  1.96s/it] 17%|█▋        | 23/134 [00:45<03:38,  1.96s/it] 18%|█▊        | 24/134 [00:47<03:36,  1.96s/it] 19%|█▊        | 25/134 [00:49<03:34,  1.96s/it] 19%|█▉        | 26/134 [00:51<03:31,  1.96s/it] 20%|██        | 27/134 [00:53<03:30,  1.96s/it] 21%|██        | 28/134 [00:55<03:27,  1.96s/it] 22%|██▏       | 29/134 [00:57<03:26,  1.96s/it] 22%|██▏       | 30/134 [00:59<03:24,  1.96s/it] 23%|██▎       | 31/134 [01:01<03:21,  1.96s/it] 24%|██▍       | 32/134 [01:03<03:20,  1.96s/it] 25%|██▍       | 33/134 [01:05<03:17,  1.96s/it] 25%|██▌       | 34/134 [01:07<03:15,  1.96s/it] 26%|██▌       | 35/134 [01:09<03:14,  1.96s/it] 27%|██▋       | 36/134 [01:11<03:12,  1.96s/it] 28%|██▊       | 37/134 [01:13<03:10,  1.96s/it] 28%|██▊       | 38/134 [01:15<03:07,  1.96s/it] 29%|██▉       | 39/134 [01:17<03:06,  1.96s/it] 30%|██▉       | 40/134 [01:19<03:04,  1.96s/it] 31%|███       | 41/134 [01:21<03:02,  1.96s/it] 31%|███▏      | 42/134 [01:23<03:00,  1.96s/it] 32%|███▏      | 43/134 [01:25<02:58,  1.96s/it] 33%|███▎      | 44/134 [01:27<02:56,  1.96s/it] 34%|███▎      | 45/134 [01:29<02:54,  1.96s/it] 34%|███▍      | 46/134 [01:31<02:52,  1.96s/it] 35%|███▌      | 47/134 [01:33<02:50,  1.97s/it] 36%|███▌      | 48/134 [01:35<02:49,  1.97s/it] 37%|███▋      | 49/134 [01:37<02:46,  1.96s/it] 37%|███▋      | 50/134 [01:38<02:44,  1.96s/it] 38%|███▊      | 51/134 [01:40<02:43,  1.96s/it] 39%|███▉      | 52/134 [01:42<02:41,  1.97s/it] 40%|███▉      | 53/134 [01:44<02:39,  1.97s/it] 40%|████      | 54/134 [01:46<02:37,  1.97s/it] 41%|████      | 55/134 [01:48<02:35,  1.97s/it] 42%|████▏     | 56/134 [01:50<02:33,  1.97s/it] 43%|████▎     | 57/134 [01:52<02:31,  1.97s/it] 43%|████▎     | 58/134 [01:54<02:29,  1.96s/it] 44%|████▍     | 59/134 [01:56<02:27,  1.96s/it] 45%|████▍     | 60/134 [01:58<02:25,  1.96s/it] 46%|████▌     | 61/134 [02:00<02:23,  1.96s/it] 46%|████▋     | 62/134 [02:02<02:21,  1.96s/it] 47%|████▋     | 63/134 [02:04<02:19,  1.96s/it] 48%|████▊     | 64/134 [02:06<02:17,  1.96s/it] 49%|████▊     | 65/134 [02:08<02:15,  1.96s/it] 49%|████▉     | 66/134 [02:10<02:13,  1.96s/it] 50%|█████     | 67/134 [02:12<02:11,  1.96s/it] 51%|█████     | 68/134 [02:14<02:09,  1.96s/it] 51%|█████▏    | 69/134 [02:16<02:07,  1.96s/it] 52%|█████▏    | 70/134 [02:18<02:05,  1.96s/it] 53%|█████▎    | 71/134 [02:20<02:03,  1.96s/it] 54%|█████▎    | 72/134 [02:22<02:01,  1.96s/it] 54%|█████▍    | 73/134 [02:24<01:59,  1.96s/it] 55%|█████▌    | 74/134 [02:26<01:57,  1.96s/it] 56%|█████▌    | 75/134 [02:28<01:55,  1.96s/it] 57%|█████▋    | 76/134 [02:30<01:54,  1.97s/it] 57%|█████▋    | 77/134 [02:31<01:52,  1.97s/it] 58%|█████▊    | 78/134 [02:33<01:50,  1.97s/it] 59%|█████▉    | 79/134 [02:35<01:48,  1.96s/it] 60%|█████▉    | 80/134 [02:37<01:46,  1.96s/it] 60%|██████    | 81/134 [02:39<01:44,  1.96s/it] 61%|██████    | 82/134 [02:41<01:42,  1.96s/it] 62%|██████▏   | 83/134 [02:43<01:40,  1.96s/it] 63%|██████▎   | 84/134 [02:45<01:38,  1.96s/it] 63%|██████▎   | 85/134 [02:47<01:36,  1.96s/it] 64%|██████▍   | 86/134 [02:49<01:34,  1.96s/it] 65%|██████▍   | 87/134 [02:51<01:32,  1.97s/it] 66%|██████▌   | 88/134 [02:53<01:30,  1.96s/it] 66%|██████▋   | 89/134 [02:55<01:28,  1.96s/it] 67%|██████▋   | 90/134 [02:57<01:26,  1.96s/it] 68%|██████▊   | 91/134 [02:59<01:24,  1.96s/it] 69%|██████▊   | 92/134 [03:01<01:22,  1.96s/it] 69%|██████▉   | 93/134 [03:03<01:20,  1.96s/it] 70%|███████   | 94/134 [03:05<01:18,  1.96s/it] 71%|███████   | 95/134 [03:07<01:16,  1.96s/it] 72%|███████▏  | 96/134 [03:09<01:14,  1.96s/it] 72%|███████▏  | 97/134 [03:11<01:12,  1.96s/it] 73%|███████▎  | 98/134 [03:13<01:10,  1.96s/it] 74%|███████▍  | 99/134 [03:15<01:08,  1.96s/it] 75%|███████▍  | 100/134 [03:17<01:06,  1.96s/it] 75%|███████▌  | 101/134 [03:19<01:04,  1.96s/it] 76%|███████▌  | 102/134 [03:20<01:02,  1.96s/it] 77%|███████▋  | 103/134 [03:22<01:00,  1.96s/it] 78%|███████▊  | 104/134 [03:24<00:58,  1.96s/it] 78%|███████▊  | 105/134 [03:26<00:56,  1.96s/it] 79%|███████▉  | 106/134 [03:28<00:54,  1.96s/it] 80%|███████▉  | 107/134 [03:30<00:52,  1.96s/it] 81%|████████  | 108/134 [03:32<00:50,  1.96s/it] 81%|████████▏ | 109/134 [03:34<00:48,  1.96s/it] 82%|████████▏ | 110/134 [03:36<00:46,  1.96s/it] 83%|████████▎ | 111/134 [03:38<00:44,  1.96s/it] 84%|████████▎ | 112/134 [03:40<00:43,  1.96s/it] 84%|████████▍ | 113/134 [03:42<00:41,  1.96s/it] 85%|████████▌ | 114/134 [03:44<00:39,  1.96s/it] 86%|████████▌ | 115/134 [03:46<00:37,  1.95s/it] 87%|████████▋ | 116/134 [03:48<00:35,  1.96s/it] 87%|████████▋ | 117/134 [03:50<00:33,  1.95s/it] 88%|████████▊ | 118/134 [03:52<00:31,  1.96s/it] 89%|████████▉ | 119/134 [03:54<00:29,  1.95s/it] 90%|████████▉ | 120/134 [03:56<00:27,  1.95s/it] 90%|█████████ | 121/134 [03:58<00:25,  1.95s/it] 91%|█████████ | 122/134 [04:00<00:23,  1.95s/it] 92%|█████████▏| 123/134 [04:02<00:21,  1.95s/it] 93%|█████████▎| 124/134 [04:03<00:19,  1.95s/it] 93%|█████████▎| 125/134 [04:05<00:17,  1.96s/it] 94%|█████████▍| 126/134 [04:07<00:15,  1.96s/it] 95%|█████████▍| 127/134 [04:09<00:13,  1.96s/it] 96%|█████████▌| 128/134 [04:11<00:11,  1.96s/it] 96%|█████████▋| 129/134 [04:13<00:09,  1.96s/it] 97%|█████████▋| 130/134 [04:15<00:07,  1.96s/it] 98%|█████████▊| 131/134 [04:17<00:05,  1.96s/it] 99%|█████████▊| 132/134 [04:19<00:03,  1.96s/it] 99%|█████████▉| 133/134 [04:21<00:01,  1.96s/it]100%|██████████| 134/134 [04:21<00:00,  1.42s/it]100%|██████████| 134/134 [04:21<00:00,  1.95s/it]
[2024-11-22 20:55:34,041][dino.evaluators][INFO] - Extracting features ...
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:01<00:26,  1.93s/it] 13%|█▎        | 2/15 [00:03<00:25,  1.92s/it] 20%|██        | 3/15 [00:05<00:23,  1.92s/it] 27%|██▋       | 4/15 [00:07<00:21,  1.92s/it] 33%|███▎      | 5/15 [00:09<00:19,  1.92s/it] 40%|████      | 6/15 [00:11<00:17,  1.92s/it] 47%|████▋     | 7/15 [00:13<00:15,  1.92s/it] 53%|█████▎    | 8/15 [00:15<00:13,  1.92s/it] 60%|██████    | 9/15 [00:17<00:11,  1.92s/it] 67%|██████▋   | 10/15 [00:19<00:09,  1.92s/it] 73%|███████▎  | 11/15 [00:21<00:07,  1.92s/it] 80%|████████  | 12/15 [00:23<00:05,  1.93s/it] 87%|████████▋ | 13/15 [00:25<00:03,  1.92s/it] 93%|█████████▎| 14/15 [00:26<00:01,  1.92s/it]100%|██████████| 15/15 [00:28<00:00,  1.87s/it]100%|██████████| 15/15 [00:28<00:00,  1.91s/it]
[2024-11-22 20:56:02,724][dino.evaluators][INFO] - Fitting KNN model ...
[2024-11-22 20:56:02,746][dino.evaluators][INFO] - Predicting ...
[2024-11-22 20:56:02,927][dino.evaluators][INFO] - Calculating accuracy ...
[2024-11-22 20:56:02,930][dino.entry_points.evaluation][INFO] - KNN accuracy: 0.99
